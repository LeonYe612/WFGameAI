# =====================================
# WFGameAI 中央配置文件
# 目的: 统一管理路径、数据库、OCR、服务等配置
# 重要说明:
# - 优先使用 ${section:option} 或 ${option} 进行路径插值
# - 避免使用绝对路径, 在生产环境使用相对路径或环境变量
# - 本文件由多个服务共享, 修改需评估全局影响
# - 值仅说明用途, 不在此处写入敏感信息
# - 变更前请阅读 `wfgame-ai-server\config_validator.py`
# =====================================

[paths]
# Python 解释器路径. 建议通过环境变量注入, 仅在开发机使用本地路径
python_path = F:\QA\Software\anaconda3\envs\py39_yolov10\python.exe

# 项目根目录. 请避免绝对路径, 推荐由启动脚本动态计算工作目录并传入
project_root = C:\Users\Administrator\PycharmProjects\WFGameAI

# 项目所有页面目录
project_pages_dir = ${project_root}\wfgame-ai-server\staticfiles\pages

# =====================================

# 服务器目录
server_dir = ${project_root}\wfgame-ai-server

# =====================================

# [脚本管理]apps 模块目录
scripts_dir = ${server_dir}\apps\scripts

# =====================================

# [测试用例]apps 模块目录
testcase_dir = ${server_dir}\apps\scripts\testcase

# =====================================

# [报告生成]apps 模块功能目录
reports_dir = ${server_dir}\apps\reports
ui_reports_dir = ${reports_dir}\ui_reports

# =====================================

# [OCR模块]apps 目录与相关路径
ocr_dir = ${server_dir}\apps\ocr
ocr_results_dir = ${project_root}\output\ocr\results
ocr_uploads_dir = ${server_dir}\media
ocr_repos_dir = ${server_dir}\media\ocr\repositories
ocr_temp_dir = ${server_dir}\media\ocr\temp
ocr_exports_dir = ${server_dir}\media\ocr\exports
ocr_logs_dir = ${server_dir}\logs\ocr

# =====================================

# 数据集目录
datasets_dir = ${project_root}\datasets

# 训练结果目录
train_results_dir = ${project_root}\train_results

# 权重文件目录
weights_dir = ${project_root}\models

# 模型文件路径
model_path = ${weights_dir}\best.pt

# =====================================

[devices_report_paths]
# 设备回放后生成报告根目录
device_replay_reports_dir = ${paths:server_dir}\staticfiles\reports

# 设备回放报告生成-静态资源目录
report_static_url = ${device_replay_reports_dir}\static

# 设备回放报告模版
template_dir = ${device_replay_reports_dir}\templates

# 单设备报告目录
single_device_reports_dir = ${device_replay_reports_dir}\ui_run\WFGameAI.air\log

# 多设备汇总报告目录
summary_reports_dir = ${device_replay_reports_dir}\summary_reports

# =====================================

[database]
# MySQL 连接参数. 生产环境请通过环境变量或密钥管理注入敏感信息
host = 172.28.133.134
port = 3307
username = root
password = qa123456
dbname = gogotest_data

[celery]
host = 127.0.0.1
port = 6379
username =
password =
db = 0
pool_nums = 20

[redis]
host = 127.0.0.1
port = 6379
username =
password =
db = 0
pool_nums = 20


[account_manager]
# 会话与资源管理配置
# 会话超时时间 (秒)
session_timeout = 3600
# 清理检查间隔 (秒)
cleanup_interval = 300
# 最大并发会话数
max_concurrent_sessions = 100
# 启用 Windows 音效通知
enable_sound_alerts = true
# 数据库连接池大小
db_pool_size = 20
# 心跳检查间隔 (秒)
heartbeat_interval = 60
# 自动迁移文件数据
auto_migrate_on_startup = true

[settings]
# 测试相关设置
default_loop_count = 1
default_max_duration = 30
confidence_threshold = 0.6

# 在配置文件中添加OCR各模式的参数设置

[ocr]
# 基础配置
gpu_enabled = true
ocr_default_lang = ch
log_filter_debug = true
log_filter_debug_save = true

# 功能设置
ocr_cache_enabled = true
ocr_cache_max_size = 4

# GPU配置
gpu_memory_threshold = 4096

# 多线程配置
ocr_max_workers = 1
ocr_batch_size = 20
thread_timeout = 600

# 语言配置
supported_languages = ch,en,jp,ko,vi
default_language = ch

# 智能模式配置
# 预设模式: high_speed(快速) | balanced(均衡) | high_precision(高精度) | smart_balanced(智能均衡)
# smart_balanced不是参数集，而是根据图片自动选择最佳模式的智能选择器
default_preset = smart_balanced

# 模型配置
text_detection_model_name = PP-OCRv5_server_det
text_recognition_model_name = PP-OCRv5_server_rec

# 高级配置（后处理过滤阈值，影响所有模式）
text_rec_score_thresh = 0.00

# 误检治理参数（全部可配置，避免硬编码）
# 小图严苛模式触发阈值（像素数）
strict_pixels_threshold = 10000
# 严苛模式整体置信度提升量
strict_conf_boost = 0.01

# 严苛模式下的检测与预处理参数
strict_limit_side_len_min = 256
strict_text_det_thresh = 0.50
strict_text_det_box_thresh = 0.75
strict_text_det_unclip_ratio = 1.30

# 几何过滤阈值
min_box_area_ratio = 0.001
min_box_side_px = 8
min_aspect_ratio = 1.3
max_aspect_ratio = 20.0

# 长度感知阈值
len2_3_conf_thresh = 0.92
len4p_conf_thresh = 0.88

# 语言比例与总体一致性门槛
lang_ratio_threshold = 0.5
overall_keep_min_count = 2
overall_keep_avg_conf = 0.90
overall_keep_len4p_conf = 0.95

# 单字复杂度感知参数
len1_conf_base = 0.92
len1_conf_high_complexity = 0.85
len1_conf_low_complexity = 0.99
edge_density_lo = 0.02
edge_density_hi = 0.08
corner_density_lo = 0.0005
corner_density_hi = 0.002
single_char_bypass_overall = true

[ocr_high_speed]
# 快速模式参数配置
text_det_thresh = 0.50
text_det_box_thresh = 0.70
text_det_unclip_ratio = 1.00
text_det_limit_type = max
text_det_limit_side_len = 960
use_textline_orientation = false
use_doc_orientation_classify = false
use_doc_unwarping = false
smart_ocr_dynamic_limit_enabled = false

[ocr_balanced]
# 均衡模式参数配置
text_det_thresh = 0.30
text_det_box_thresh = 0.60
text_det_unclip_ratio = 1.50
text_det_limit_type = min
text_det_limit_side_len = 960
use_textline_orientation = false
use_doc_orientation_classify = false
use_doc_unwarping = false
smart_ocr_dynamic_limit_enabled = true

[ocr_high_precision]
# 高精度模式参数配置
text_det_thresh = 0.20
text_det_box_thresh = 0.40
text_det_unclip_ratio = 0.00
text_det_limit_type = min
text_det_limit_side_len = 960
use_textline_orientation = false
use_doc_orientation_classify = false
use_doc_unwarping = false
smart_ocr_dynamic_limit_enabled = false




# 性能监控
enable_performance_monitoring = true
monitoring_interval = 10

# 安全配置
max_file_size_mb = 100
max_files_per_task = 1000
allowed_image_formats = jpg,jpeg,png,bmp,tiff,tif,webp
blocked_file_extensions = exe,dll,bat,sh,cmd,js,php,py

# 文件管理配置
results_retention_days = 30
temp_file_cleanup_interval = 3600
enable_auto_cleanup = true

# 性能优化配置
ocr_instance_pool_enabled = true
ocr_warm_cache_on_startup = true
ocr_flush_interval = 3

