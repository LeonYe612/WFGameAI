# WFGame AI 集成式报告功能说明

## 概述

集成式报告功能是对WFGame AI自动化测试平台报告系统的增强，它将设备详细报告直接嵌入到汇总报告中，让用户能够在一个页面中查看所有测试结果，无需跳转到多个页面。

## 新增功能

1. **集成式报告页面**：
   - 在原有的汇总报告基础上增加了设备详情的嵌入式展示
   - 可通过折叠面板展开/折叠查看各设备的详细报告
   - 文件命名为`integrated_report_YYYY-MM-DD-HH-MM-SS.html`

2. **快速访问链接**：
   - 在报告列表页增加了"集成报告"按钮，直接打开集成式报告
   - 在报告详情页增加了"查看集成报告"按钮

3. **自动生成工具**：
   - 添加了多个工具脚本，用于自动生成和更新集成报告

## 如何使用

### 查看集成报告

1. 在报告列表页，点击"集成报告"按钮直接在新窗口打开
2. 在报告详情页，点击"查看集成报告"按钮在新窗口打开

### 手动创建集成报告

如果需要手动创建或更新集成报告，可以使用以下方法：

1. 运行`update_reports.bat`批处理文件
2. 或者在命令行中执行`python create_integrated_reports.py`

### 自动创建集成报告

系统已配置为在生成新报告时自动创建集成报告。如果需要手动触发此功能，可以：

1. 运行`run_report_hooks.bat`批处理文件
2. 或者在命令行中执行`python apps/reports/report_hooks.py`

## 技术细节

### 目录结构

```
wfgame-ai-server/
├── apps/
│   └── reports/
│       ├── summary_reports/          # 汇总报告原始目录
│       ├── ui_run/                   # 设备报告原始目录
│       └── report_hooks.py           # 报告挂钩脚本
│
├── staticfiles/
│   └── reports/
│       ├── summary_reports/          # 汇总报告静态服务目录
│       │   ├── summary_report_*.html # 原始汇总报告
│       │   └── integrated_report_*.html # 集成式报告
│       └── ui_run/                   # 设备报告静态服务目录
│
├── create_integrated_reports.py      # 集成报告生成脚本
├── update_reports.bat                # 报告更新批处理文件
└── run_report_hooks.bat              # 报告挂钩运行批处理文件
```

### 工作原理

1. 集成报告生成器会分析原始汇总报告中的设备链接
2. 为每个设备创建一个折叠面板和嵌入框架
3. 使用iframe将设备报告嵌入到汇总报告中
4. 保存为新的集成式报告文件

## 故障排除

如果遇到集成报告不显示的问题，请检查：

1. 设备报告文件是否已复制到静态目录
2. 设备报告链接是否正确指向`/static/reports/ui_run/`目录
3. 浏览器是否阻止了iframe内容的加载（可能需要调整安全设置）

## 提示与技巧

1. 集成报告较大，首次加载可能较慢，请耐心等待
2. 设备报告的iframe高度固定为600像素，可通过点击"新窗口打开"查看完整报告
3. 如需修改iframe的高度或样式，可编辑`create_integrated_reports.py`脚本
