import{g as F,r as k,d as I,e as q,f as O,j as Q,k as J,l as A,m as H}from"./index-8ca571cf.js";import{l as R,z as s,h as o,j as _,k as r,y as t,v as c,H as l,A as x,Q as f,q as m,x as y,aO as G,ah as K,ai as L,_ as P}from"./index-e046f3d2.js";const W=v=>(K("data-v-a8f88d35"),v=v(),L(),v),X={key:0,class:"flex items-center justify-between mb-4"},Y={class:"flex items-center space-x-4"},Z={class:"flex items-center space-x-2"},ee={key:1,class:"text-center py-12"},te=W(()=>r("p",{class:"text-gray-500"},"正在加载数据源列表...",-1)),ae={class:"flex items-center"},le={class:"font-medium"},oe={key:0,class:"text-xs text-gray-500"},ne={key:0},se={key:1,class:"text-gray-400"},ce={class:"flex space-x-1"},de=R({name:"DataSourcesTable",__name:"dataSourcesTable",props:{dataSources:{},loading:{type:Boolean},error:{},searchQuery:{},statusFilter:{},typeFilter:{},filteredDataSources:{}},emits:["refresh","edit","delete","test-connection","refresh-source","export","update:search-query","update:status-filter","update:type-filter"],setup(v,{emit:d}){const T=e=>({connected:"已连接",disconnected:"未连接",error:"连接失败"})[e]||e,V=e=>({connected:"success",disconnected:"info",error:"danger"})[e]||"info",z=e=>({excel:"Excel",csv:"CSV",database:"数据库",json:"JSON"})[e]||e,B=e=>{d("edit",e)},M=async e=>{try{await G.confirm(`确定要删除数据源 "${e.name}" 吗？此操作不可撤销。`,"确认删除",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}),d("delete",e.id)}catch{}},$=e=>{d("test-connection",e.id)},D=e=>{d("refresh-source",e.id)},E=e=>{d("export",e)};return(e,n)=>{const N=s("el-input"),i=s("el-option"),g=s("el-select"),p=s("el-button"),C=s("el-icon"),j=s("el-alert"),w=s("el-empty"),u=s("el-table-column"),S=s("el-tag"),h=s("el-tooltip"),U=s("el-table");return o(),_("div",null,[!e.loading&&e.dataSources.length>0?(o(),_("div",X,[r("div",Y,[t(N,{"model-value":e.searchQuery,"onUpdate:modelValue":n[0]||(n[0]=a=>d("update:search-query",a)),placeholder:"搜索数据源名称、类型...","prefix-icon":c(F),style:{width:"300px"},clearable:""},null,8,["model-value","prefix-icon"]),t(g,{"model-value":e.statusFilter,"onUpdate:modelValue":n[1]||(n[1]=a=>d("update:status-filter",a)),placeholder:"所有状态",style:{width:"120px"},clearable:""},{default:l(()=>[t(i,{label:"已连接",value:"connected"}),t(i,{label:"未连接",value:"disconnected"}),t(i,{label:"连接失败",value:"error"})]),_:1},8,["model-value"]),t(g,{"model-value":e.typeFilter,"onUpdate:modelValue":n[2]||(n[2]=a=>d("update:type-filter",a)),placeholder:"所有类型",style:{width:"120px"},clearable:""},{default:l(()=>[t(i,{label:"Excel",value:"excel"}),t(i,{label:"CSV",value:"csv"}),t(i,{label:"数据库",value:"database"}),t(i,{label:"JSON",value:"json"})]),_:1},8,["model-value"])]),r("div",Z,[t(p,{icon:c(k),type:"primary",onClick:n[3]||(n[3]=a=>d("refresh"))},{default:l(()=>[x(" 刷新 ")]),_:1},8,["icon"])])])):f("",!0),e.loading?(o(),_("div",ee,[t(C,{class:"animate-spin text-4xl text-primary mb-4"},{default:l(()=>[t(c(k))]),_:1}),te])):f("",!0),e.error?(o(),m(j,{key:2,title:e.error,type:"error",class:"mb-4","show-icon":""},null,8,["title"])):f("",!0),!e.loading&&e.dataSources.length===0?(o(),m(w,{key:3,description:"暂无数据源，请创建新的数据源",class:"py-12"})):f("",!0),!e.loading&&e.dataSources.length>0?(o(),m(U,{key:4,data:e.filteredDataSources,stripe:"",style:{width:"100%"},class:"data-sources-table"},{default:l(()=>[t(u,{prop:"name",label:"名称","min-width":"150"},{default:l(({row:a})=>[r("div",ae,[t(C,{class:"mr-2 text-primary"},{default:l(()=>[a.type==="excel"||a.type==="csv"?(o(),m(c(I),{key:0})):a.type==="database"?(o(),m(c(q),{key:1})):(o(),m(c(O),{key:2}))]),_:2},1024),r("div",null,[r("div",le,y(a.name),1),a.description?(o(),_("div",oe,y(a.description),1)):f("",!0)])])]),_:1}),t(u,{prop:"type",label:"类型",width:"100"},{default:l(({row:a})=>[t(S,{type:"info",size:"small"},{default:l(()=>[x(y(z(a.type)),1)]),_:2},1024)]),_:1}),t(u,{prop:"status",label:"连接状态",width:"100"},{default:l(({row:a})=>[t(S,{type:V(a.status),size:"small"},{default:l(()=>[x(y(T(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(u,{prop:"recordCount",label:"数据量",width:"100"},{default:l(({row:a})=>[a.recordCount>0?(o(),_("span",ne,y(a.recordCount)+"条",1)):(o(),_("span",se,"--"))]),_:1}),t(u,{prop:"lastUpdated",label:"最后更新",width:"120"},{default:l(({row:a})=>[x(y(a.lastUpdated||"--"),1)]),_:1}),t(u,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[r("div",ce,[t(h,{content:"测试连接",placement:"top"},{default:l(()=>[t(p,{size:"small",type:"success",icon:c(Q),onClick:b=>$(a)},null,8,["icon","onClick"])]),_:2},1024),t(h,{content:"刷新数据",placement:"top"},{default:l(()=>[t(p,{size:"small",type:"primary",icon:c(k),onClick:b=>D(a)},null,8,["icon","onClick"])]),_:2},1024),t(h,{content:"导出数据",placement:"top"},{default:l(()=>[t(p,{size:"small",type:"info",icon:c(J),disabled:a.status!=="connected"||a.recordCount===0,onClick:b=>E(a)},null,8,["icon","disabled","onClick"])]),_:2},1024),t(h,{content:"编辑",placement:"top"},{default:l(()=>[t(p,{size:"small",type:"warning",icon:c(A),onClick:b=>B(a)},null,8,["icon","onClick"])]),_:2},1024),t(h,{content:"删除",placement:"top"},{default:l(()=>[t(p,{size:"small",type:"danger",icon:c(H),onClick:b=>M(a)},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):f("",!0)])}}});const pe=P(de,[["__scopeId","data-v-a8f88d35"]]);export{pe as default};
