import{m as K,r as _,o as Q,w as W,A as i,O as X,j as r,u as c,I as n,z as o,B as b,P as Y,x as a,l as g,R as h,k as B,y as N,aE as Z,N as ee}from"./index-fbbdd03e.js";import{z as te,a as ne,r as le,w as oe}from"./index-ccf167da.js";import{F as ae}from"./file-14eaafa3.js";import{T as se}from"./team-b2bfcf59.js";import{useSysTeamManagement as ie}from"./hook-23d753fa.js";const re={class:"flex items-center"},ue={class:"inline-flex items-center align-middle justify-start"},ce={key:0},de={key:1},fe={class:"flex items-center justify-center mt-4 text-gray-400"},ye=K({name:"TeamSelector",__name:"index",props:{title:{type:String,default:"请选择团队："},scope:{type:String,default:"all"}},emits:["complete"],setup($,{expose:E,emit:j}){const v=$,A=j,d=_(),x=_(),C=_(v.title),f=_(!1),y=_(),{dataList:w,loading:F,fetchData:z,toggleTableExpansion:R}=ie({teamTableRef:y});Q(()=>{z(v.scope)});const k=t=>{var e;(e=y.value)==null||e.setCurrentRow(t)},I=t=>{var e;if(t.genre!=2){(e=y.value)==null||e.toggleRowExpansion(t),k(x.value);return}},M=(t,e)=>{d.value=t,x.value=e};W(d,t=>{const e=t?t.name:"";C.value=`${v.title}${e}`});const T=(t,e)=>{const u=(t==null?void 0:t.length)||0;for(let m=0;m<u;m++){const s=t[m];if(s.id==e)return s;if(s.children&&s.children.length>0){const p=T(s.children,e);if(p)return p}}return null},D=t=>{if(k(),t){const e=T(w.value,t);e&&ee(()=>{k(e)})}},L=t=>{f.value=!0,D(t==null?void 0:t.id)},O=()=>{z(v.scope,()=>{var t;D((t=d.value)==null?void 0:t.id)})},P=()=>{f.value=!1},U=t=>{if(t.genre!=1&&t.genre==2){k(t),V();return}},V=()=>{if(!d.value){Z("尚未选择任何团队",{type:"error"});return}A("complete",d.value),f.value=!1};return E({show:L}),(t,e)=>{const u=i("el-button"),m=i("el-button-group"),s=i("el-icon"),p=i("el-table-column"),S=i("el-tag"),q=i("el-tooltip"),G=i("el-table"),H=i("el-dialog"),J=X("loading");return r(),c(H,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),title:C.value,width:"25vw",draggable:!0,"align-center":"",class:"pt-2"},{footer:n(()=>[o(u,{onClick:P,size:"large"},{default:n(()=>[...e[7]||(e[7]=[b("取 消",-1)])]),_:1}),o(u,{type:"primary",onClick:V,size:"large"},{default:n(()=>[...e[8]||(e[8]=[b(" 确定 ",-1)])]),_:1})]),default:n(()=>[Y((r(),c(G,{class:"team-selector-table cursor-pointer select-none","empty-text":"您尚未加入任何团队",data:a(w),"default-expand-all":"","row-key":"id","max-height":"50vh",height:"44vh","tree-props":{children:"children"},ref_key:"teamTableRef",ref:y,"table-layout":"auto","highlight-current-row":"","current-row-key":"id",onRowClick:I,onRowDblclick:U,onCurrentChange:M},{default:n(()=>[o(p,{label:"名称",prop:"meta.title"},{header:n(()=>[g("div",re,[e[3]||(e[3]=g("span",null,"名称",-1)),o(m,{class:"ml-2"},{default:n(()=>[o(u,{title:"展开所有",type:"default",plain:"",size:"small",icon:a(te),onClick:e[0]||(e[0]=l=>a(R)(!0))},null,8,["icon"]),o(u,{title:"合并所有",type:"default",plain:"",size:"small",icon:a(ne),onClick:e[1]||(e[1]=l=>a(R)(!1))},null,8,["icon"]),o(u,{title:"刷新数据",type:"default",plain:"",size:"small",icon:a(le),onClick:O},null,8,["icon"])]),_:1})])]),default:n(({row:l})=>[g("div",ue,[o(s,{size:22},{default:n(()=>[l.genre==1?(r(),c(a(ae),{key:0})):h("",!0),l.genre==2?(r(),c(a(se),{key:1})):h("",!0)]),_:2},1024),o(s),l.genre==1?(r(),B("span",ce,N(l.name),1)):(r(),B("span",de,N(l.name),1))])]),_:1}),o(p,{align:"center",label:"类型"},{default:n(({row:l})=>[l.genre==1?(r(),c(S,{key:0,type:"warning",effect:"plain"},{default:n(()=>[...e[4]||(e[4]=[b("目录",-1)])]),_:1})):h("",!0),l.genre==2?(r(),c(q,{key:1,effect:"light",content:`ID:${l.id}`,placement:"right"},{default:n(()=>[o(S,{effect:"plain"},{default:n(()=>[...e[5]||(e[5]=[b("团队",-1)])]),_:1})]),_:1},8,["content"])):h("",!0)]),_:1})]),_:1},8,["data"])),[[J,a(F)]]),g("div",fe,[o(s,{size:16},{default:n(()=>[o(a(oe))]),_:1}),e[6]||(e[6]=g("span",{class:"text-sm font-semibold ml-1"},"小贴士: 双击选项可以实现快速选择",-1))])]),_:1},8,["modelValue","title"])}}});export{ye as _};
