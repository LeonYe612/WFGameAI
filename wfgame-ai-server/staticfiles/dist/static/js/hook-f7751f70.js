import{aP as a,r as n,$ as v,aF as i}from"./index-c3bc70ba.js";import{s}from"./request-6dd7bfdd.js";const S=()=>a.request("get","/api/system/settings/"),b=t=>a.request("post","/api/system/settings/",{data:t}),P=()=>a.request("get","/api/system/python-envs/"),f=t=>a.request("post","/api/system/switch-python-env/",{data:t}),M=()=>a.request("post","/api/system/settings/reset/");function A(){const t=n(!1),l=n("general"),c=v({systemName:"WFGame AI自动化测试平台",adminEmail:"admin@example.com",maxDevice:100,reportRetentionDays:90,timeZone:"Asia/Shanghai",enableNotifications:!0,enableAutoBackup:!0,debugMode:!1}),r=n([]),u=n(!1),o=n(""),g=[{id:"general",label:"通用设置",icon:"Setting",component:"GeneralSettings"},{id:"python",label:"Python环境",icon:"Monitor",component:"PythonSettings"},{id:"user",label:"用户管理",icon:"User",component:"UserManagement"},{id:"ai",label:"AI设置",icon:"MagicStick",component:"AISettings"},{id:"backup",label:"备份与恢复",icon:"Download",component:"BackupRestore"},{id:"log",label:"系统日志",icon:"Document",component:"SystemLog"},{id:"api",label:"API配置",icon:"Link",component:"APISettings"}],y=[{value:"Asia/Shanghai",label:"中国标准时间 (UTC+8)"},{value:"UTC",label:"协调世界时 (UTC)"},{value:"America/New_York",label:"美国东部时间 (UTC-5)"},{value:"Europe/London",label:"英国时间 (UTC+0)"}],m=async()=>{await s({apiFunc:S,onBeforeRequest:()=>{t.value=!0},onSucceed:e=>{Object.assign(c,e)},onFailed:e=>{i(`获取系统设置失败: ${e}`,{type:"error"})},onCompleted:()=>{t.value=!1}})},h=async()=>{await s({apiFunc:b,apiParams:c,enableSucceedMsg:!0,succeedMsgContent:"系统设置保存成功！",onFailed:()=>{i("保存系统设置失败",{type:"error"})}})},d=async()=>{await s({apiFunc:M,enableSucceedMsg:!0,succeedMsgContent:"系统设置重置成功！",onSucceed:()=>{m()},onFailed:()=>{i("重置系统设置失败",{type:"error"})}})},p=async()=>{await s({apiFunc:P,onBeforeRequest:()=>{u.value=!0,o.value=""},onSucceed:e=>{e.success?r.value=e.envs||[]:o.value=e.message||"获取Python环境失败"},onFailed:e=>{o.value=e.message||"获取Python环境失败",r.value=[]},onCompleted:()=>{u.value=!1}})};return{loading:t,activeMenu:l,systemSettings:c,pythonEnvs:r,pythonEnvLoading:u,pythonEnvError:o,menuItems:g,timeZoneOptions:y,fetchSystemSettings:m,saveSettings:h,resetSettings:d,fetchPythonEnvironments:p,switchPythonEnv:async e=>{await s({apiFunc:f,apiParams:{path:e},enableSucceedMsg:!0,succeedMsgContent:"Python环境切换成功！",onSucceed:()=>{p()},onFailed:()=>{i("切换Python环境失败",{type:"error"})}})},switchMenu:e=>{l.value=e}}}export{A as useSettingsManagement};
