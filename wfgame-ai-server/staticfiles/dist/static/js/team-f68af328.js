import{aR as m,s as r,f as n,aS as o,am as u,aD as T}from"./index-41f05ddf.js";import{s as l,l as E,a as f}from"./team-e495a6d3.js";import{s as a}from"./request-28f7529e.js";import{g as i}from"./enums-b2002ef1.js";const h=m(),_=n({id:"current-team",state:()=>({teamId:0,teamName:"未选择团队",teamFullNames:["未选择团队"],mineTeamOptions:[],allTeamOptions:[],refreshLoading:!1,animate:!1}),actions:{SET_TEAM_ID(e){this.teamId=e},SET_TEAM_NAME(e){this.teamName=e},SET_TEAM_FULL_NAMES(e){this.teamFullNames=e},GET_TEAM_FULL_NAMES(){var e;return(e=this.teamFullNames)==null?void 0:e.join(" • ")},SET_TEAM(e){this.teamId=e.id||0,this.teamName=e.name||"未选择团队",this.teamFullNames=e.full_name||["未选择团队"],e!=null&&e.perms&&(h.SET_PERMS(e.perms),o({perms:e.perms}))},GET_TEAM_GM_TYPE(){const e=this.GET_TEAM_FULL_NAMES();for(const s in i)if(e.includes(i[s].label))return i[s].value;return i.UNKNOWN.value},GET_MINE_TEAM_OPTIONS(){if(this.mineTeamOptions.length>0)return this.mineTeamOptions;this.refreshTeamOptions("mine")},async switchTeam(e=0,s=!0){await a({apiFunc:l,apiParams:{id:e},onSucceed:t=>{this.SET_TEAM(t),this.animate=!0,setTimeout(()=>{this.animate=!1},1e3),e&&s&&(u(),T())}})},async refreshTeamOptions(e="mine",s){await a({apiFunc:e==="mine"?E:f,onBeforeRequest:()=>{this.refreshLoading=!0},onSucceed:t=>{e==="mine"?this.mineTeamList=t.data:this.allTeamList=t.data,typeof s=="function"&&s()},onCompleted:()=>{this.refreshLoading=!1}})}}});function N(){return _(r)}export{N as u};
