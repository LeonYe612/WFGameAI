import{a as J}from"./ocr-397e26db.js";import{g as S,A as K}from"./index-8ca571cf.js";import{s as W}from"./request-d2ecd641.js";import X from"./OcrResultCard-04ef876a.js";import{s as R,o as Y,a as ee}from"./enums-b2002ef1.js";import{l as ae,r as f,$ as N,c as te,w as le,z as o,N as oe,h as i,j as p,y as a,H as t,v as d,F as k,m as x,q as g,k as b,x as D,A as E,O as ne,Q as se,aN as re,aZ as ie,_ as ce}from"./index-e046f3d2.js";const ue={class:"flex-full flex-col"},de={class:"card-list-container","element-loading-text":"正在加载..."},_e={key:1,class:"card-grid"},pe={class:"pagination-wrapper"},me=ae({__name:"OcrResultList",props:{taskId:{}},setup(L){const v=L,h=f(!1),m=f([]),n=N({has_match:null,result_type:"",keyword:""}),c=N({currentPage:1,pageSize:24,total:0}),y=f(!1),O=f(null),V=f(0),B=te(()=>m.value.map(s=>ie(s.image_path))),U=s=>{const l=m.value.findIndex(u=>u.id===s.id);l!==-1&&(V.value=l,y.value=!0)},_=async()=>{var s,l;if(v.taskId){h.value=!0;try{const u={id:v.taskId,page:c.currentPage,page_size:c.pageSize,...n},r=await W({apiFunc:J.getDetails,apiParams:u});m.value=((s=r==null?void 0:r.data)==null?void 0:s.results)||[],c.total=((l=r==null?void 0:r.data)==null?void 0:l.total)||0}catch(u){re.error("获取结果列表失败"),console.error(u)}finally{h.value=!1}}},w=()=>{c.currentPage=1,_()},A=()=>{n.has_match=null,n.result_type="",n.keyword="",w()},F=s=>{c.pageSize=s,c.currentPage=1,_()},T=s=>{c.currentPage=s,_()};return le(()=>v.taskId,_,{immediate:!0}),(s,l)=>{const u=o("el-input"),r=o("el-form-item"),C=o("el-radio-button"),z=o("el-radio-group"),I=o("el-button"),j=o("el-form"),P=o("el-card"),q=o("el-image-viewer"),M=o("el-col"),$=o("el-row"),H=o("el-empty"),Q=o("el-scrollbar"),Z=o("el-pagination"),G=oe("loading");return i(),p("div",ue,[a(P,{class:"filter-card"},{default:t(()=>[a(j,{model:n,inline:""},{default:t(()=>[a(r,{label:""},{default:t(()=>[a(u,{modelValue:n.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>n.keyword=e),placeholder:"输入关键字查找","prefix-icon":d(S),clearable:"",style:{width:"300px"},onChange:w},null,8,["modelValue","prefix-icon"])]),_:1}),a(r,{label:"结果类型"},{default:t(()=>[a(z,{modelValue:n.result_type,"onUpdate:modelValue":l[1]||(l[1]=e=>n.result_type=e),onChange:_},{default:t(()=>[(i(!0),p(k,null,x(d(R)(d(Y)),e=>(i(),g(C,{key:e.value,label:e.value},{default:t(()=>[b("span",null,D(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"匹配状态"},{default:t(()=>[a(z,{modelValue:n.has_match,"onUpdate:modelValue":l[2]||(l[2]=e=>n.has_match=e),onChange:_},{default:t(()=>[(i(!0),p(k,null,x(d(R)(d(ee)),e=>(i(),g(C,{key:e.value,label:e.value},{default:t(()=>[b("span",null,D(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(r,null,{default:t(()=>[a(I,{icon:d(S),type:"primary",onClick:w,plain:""},{default:t(()=>[E(" 搜索 ")]),_:1},8,["icon"]),a(I,{icon:d(K),onClick:A},{default:t(()=>[E(" 重置 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),a(P,{class:"table-card","body-style":"display: flex; flex-direction: column; flex: 1; overflow: hidden;"},{default:t(()=>[ne((i(),p("div",de,[a(Q,null,{default:t(()=>[y.value?(i(),g(q,{key:0,ref_key:"imageViewer",ref:O,"url-list":B.value,"show-progress":"","hide-on-click-modal":"","initial-index":V.value,onClose:l[3]||(l[3]=e=>y.value=!1)},null,8,["url-list","initial-index"])):se("",!0),m.value.length>0?(i(),p("div",_e,[a($,{gutter:16},{default:t(()=>[(i(!0),p(k,null,x(m.value,e=>(i(),g(M,{class:"mb-4",key:e.id,xs:24,sm:12,md:8,lg:6,xl:4},{default:t(()=>[a(X,{result:e,onViewImage:U},null,8,["result"])]),_:2},1024))),128))]),_:1})])):(i(),g(H,{key:2,description:"暂无数据"}))]),_:1})])),[[G,h.value]]),b("div",pe,[a(Z,{"current-page":c.currentPage,"page-size":c.pageSize,total:c.total,"page-sizes":[24,36,48,60],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:T,background:""},null,8,["current-page","page-size","total"])])]),_:1})])}}});const ke=ce(me,[["__scopeId","data-v-1901366c"]]);export{ke as default};
