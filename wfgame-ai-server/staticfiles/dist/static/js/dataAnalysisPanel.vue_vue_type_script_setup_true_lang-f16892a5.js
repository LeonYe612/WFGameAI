import{t as D,h as E}from"./index-8ca571cf.js";import{A}from"./types-5a18ccfd.js";import{l as P,r as S,c as F,z as o,h as a,j as r,y as d,H as l,k as t,v as y,F as v,m as f,q as u,x as _,A as V,Q as h,aN as I}from"./index-e046f3d2.js";const L={class:"space-y-4"},U={class:"flex items-center"},Y=t("span",{class:"font-medium"},"数据分析",-1),$={class:"space-y-4"},q=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 选择数据源 ",-1),H=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 分析类型 ",-1),J={class:"text-xs text-gray-500"},M={class:"flex justify-end"},O=t("span",{class:"font-medium"},"分析结果",-1),Q={class:"space-y-4"},G={class:"flex items-center justify-between mb-2"},K={class:"flex items-center"},W={class:"text-xs text-gray-500"},X={class:"text-sm"},Z={class:"bg-white p-3 rounded border text-xs overflow-auto max-h-60"},ae=P({name:"DataAnalysisPanel",__name:"dataAnalysisPanel",props:{dataSources:{},analysisResults:{},loading:{type:Boolean}},emits:["analyze"],setup(w,{emit:N}){const C=w,i=S(""),c=S(""),m=F(()=>C.dataSources.filter(s=>s.status==="connected")),z=()=>{if(!i.value||!c.value){I.warning("请选择数据源和分析类型");return}N("analyze",i.value,c.value)},B=s=>{const n=A.find(p=>p.value===s);return n?n.label:s},R=s=>typeof s=="string"?s:typeof s=="object"?JSON.stringify(s,null,2):String(s);return(s,n)=>{const p=o("el-icon"),g=o("el-option"),b=o("el-select"),T=o("el-button"),x=o("el-card"),j=o("el-tag"),k=o("el-empty");return a(),r("div",L,[d(x,{shadow:"never",class:"border"},{header:l(()=>[t("div",U,[d(p,{class:"mr-2"},{default:l(()=>[d(y(D))]),_:1}),Y])]),default:l(()=>[t("div",$,[t("div",null,[q,d(b,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),placeholder:"请选择要分析的数据源",style:{width:"100%"}},{default:l(()=>[(a(!0),r(v,null,f(m.value,e=>(a(),u(g,{key:e.id,label:`${e.name} (${e.recordCount}条)`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",null,[H,d(b,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),placeholder:"请选择分析类型",style:{width:"100%"}},{default:l(()=>[(a(!0),r(v,null,f(y(A),e=>(a(),u(g,{key:e.value,label:e.label,value:e.value},{default:l(()=>[t("div",null,[t("div",null,_(e.label),1),t("div",J,_(e.description),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",M,[d(T,{type:"primary",icon:y(E),loading:s.loading,disabled:!i.value||!c.value,onClick:z},{default:l(()=>[V(" 开始分析 ")]),_:1},8,["icon","loading","disabled"])])])]),_:1}),s.analysisResults.length>0?(a(),u(x,{key:0,shadow:"never",class:"border"},{header:l(()=>[O]),default:l(()=>[t("div",Q,[(a(!0),r(v,null,f(s.analysisResults,e=>(a(),r("div",{key:e.id,class:"p-4 bg-gray-50 rounded-lg"},[t("div",G,[t("div",K,[d(j,{type:"primary",size:"small"},{default:l(()=>[V(_(B(e.analysisType)),1)]),_:2},1024)]),t("div",W,_(e.createdAt),1)]),t("div",X,[t("pre",Z,_(R(e.result)),1)])]))),128))])]),_:1})):h("",!0),m.value.length===0?(a(),u(k,{key:1,description:"暂无可用的数据源进行分析，请先创建并连接数据源",class:"py-12"})):h("",!0),m.value.length>0&&s.analysisResults.length===0?(a(),u(k,{key:2,description:"暂无分析结果，请选择数据源和分析类型开始分析",class:"py-8"})):h("",!0)])}}});export{ae as _};
