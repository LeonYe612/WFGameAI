import{g as F,r as x,d as q,e as I,f as J,j as O,k as Q,l as R,m as A}from"./index-ccf167da.js";import{m as G,A as s,j as o,k as _,l as r,z as t,x as c,I as a,B as h,R as m,u as f,y,aG as H,_ as K}from"./index-fbbdd03e.js";const L={key:0,class:"flex items-center justify-between mb-4"},P={class:"flex items-center space-x-4"},W={class:"flex items-center space-x-2"},X={key:1,class:"text-center py-12"},Y={class:"flex items-center"},Z={class:"font-medium"},ee={key:0,class:"text-xs text-gray-500"},te={key:0},le={key:1,class:"text-gray-400"},ae={class:"flex space-x-1"},ne=G({name:"DataSourcesTable",__name:"dataSourcesTable",props:{dataSources:{},loading:{type:Boolean},error:{},searchQuery:{},statusFilter:{},typeFilter:{},filteredDataSources:{}},emits:["refresh","edit","delete","test-connection","refresh-source","export","update:search-query","update:status-filter","update:type-filter"],setup(oe,{emit:S}){const d=S,T=e=>({connected:"已连接",disconnected:"未连接",error:"连接失败"})[e]||e,B=e=>({connected:"success",disconnected:"info",error:"danger"})[e]||"info",V=e=>({excel:"Excel",csv:"CSV",database:"数据库",json:"JSON"})[e]||e,z=e=>{d("edit",e)},M=async e=>{try{await H.confirm(`确定要删除数据源 "${e.name}" 吗？此操作不可撤销。`,"确认删除",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}),d("delete",e.id)}catch{}},$=e=>{d("test-connection",e.id)},D=e=>{d("refresh-source",e.id)},E=e=>{d("export",e)};return(e,n)=>{const N=s("el-input"),i=s("el-option"),k=s("el-select"),p=s("el-button"),g=s("el-icon"),j=s("el-alert"),U=s("el-empty"),u=s("el-table-column"),C=s("el-tag"),b=s("el-tooltip"),w=s("el-table");return o(),_("div",null,[!e.loading&&e.dataSources.length>0?(o(),_("div",L,[r("div",P,[t(N,{"model-value":e.searchQuery,"onUpdate:modelValue":n[0]||(n[0]=l=>d("update:search-query",l)),placeholder:"搜索数据源名称、类型...","prefix-icon":c(F),style:{width:"300px"},clearable:""},null,8,["model-value","prefix-icon"]),t(k,{"model-value":e.statusFilter,"onUpdate:modelValue":n[1]||(n[1]=l=>d("update:status-filter",l)),placeholder:"所有状态",style:{width:"120px"},clearable:""},{default:a(()=>[t(i,{label:"已连接",value:"connected"}),t(i,{label:"未连接",value:"disconnected"}),t(i,{label:"连接失败",value:"error"})]),_:1},8,["model-value"]),t(k,{"model-value":e.typeFilter,"onUpdate:modelValue":n[2]||(n[2]=l=>d("update:type-filter",l)),placeholder:"所有类型",style:{width:"120px"},clearable:""},{default:a(()=>[t(i,{label:"Excel",value:"excel"}),t(i,{label:"CSV",value:"csv"}),t(i,{label:"数据库",value:"database"}),t(i,{label:"JSON",value:"json"})]),_:1},8,["model-value"])]),r("div",W,[t(p,{icon:c(x),type:"primary",onClick:n[3]||(n[3]=l=>d("refresh"))},{default:a(()=>[...n[4]||(n[4]=[h(" 刷新 ",-1)])]),_:1},8,["icon"])])])):m("",!0),e.loading?(o(),_("div",X,[t(g,{class:"animate-spin text-4xl text-primary mb-4"},{default:a(()=>[t(c(x))]),_:1}),n[5]||(n[5]=r("p",{class:"text-gray-500"},"正在加载数据源列表...",-1))])):m("",!0),e.error?(o(),f(j,{key:2,title:e.error,type:"error",class:"mb-4","show-icon":""},null,8,["title"])):m("",!0),!e.loading&&e.dataSources.length===0?(o(),f(U,{key:3,description:"暂无数据源，请创建新的数据源",class:"py-12"})):m("",!0),!e.loading&&e.dataSources.length>0?(o(),f(w,{key:4,data:e.filteredDataSources,stripe:"",style:{width:"100%"},class:"data-sources-table"},{default:a(()=>[t(u,{prop:"name",label:"名称","min-width":"150"},{default:a(({row:l})=>[r("div",Y,[t(g,{class:"mr-2 text-primary"},{default:a(()=>[l.type==="excel"||l.type==="csv"?(o(),f(c(q),{key:0})):l.type==="database"?(o(),f(c(I),{key:1})):(o(),f(c(J),{key:2}))]),_:2},1024),r("div",null,[r("div",Z,y(l.name),1),l.description?(o(),_("div",ee,y(l.description),1)):m("",!0)])])]),_:1}),t(u,{prop:"type",label:"类型",width:"100"},{default:a(({row:l})=>[t(C,{type:"info",size:"small"},{default:a(()=>[h(y(V(l.type)),1)]),_:2},1024)]),_:1}),t(u,{prop:"status",label:"连接状态",width:"100"},{default:a(({row:l})=>[t(C,{type:B(l.status),size:"small"},{default:a(()=>[h(y(T(l.status)),1)]),_:2},1032,["type"])]),_:1}),t(u,{prop:"recordCount",label:"数据量",width:"100"},{default:a(({row:l})=>[l.recordCount>0?(o(),_("span",te,y(l.recordCount)+"条",1)):(o(),_("span",le,"--"))]),_:1}),t(u,{prop:"lastUpdated",label:"最后更新",width:"120"},{default:a(({row:l})=>[h(y(l.lastUpdated||"--"),1)]),_:1}),t(u,{label:"操作",width:"200",fixed:"right"},{default:a(({row:l})=>[r("div",ae,[t(b,{content:"测试连接",placement:"top"},{default:a(()=>[t(p,{size:"small",type:"success",icon:c(O),onClick:v=>$(l)},null,8,["icon","onClick"])]),_:2},1024),t(b,{content:"刷新数据",placement:"top"},{default:a(()=>[t(p,{size:"small",type:"primary",icon:c(x),onClick:v=>D(l)},null,8,["icon","onClick"])]),_:2},1024),t(b,{content:"导出数据",placement:"top"},{default:a(()=>[t(p,{size:"small",type:"info",icon:c(Q),disabled:l.status!=="connected"||l.recordCount===0,onClick:v=>E(l)},null,8,["icon","disabled","onClick"])]),_:2},1024),t(b,{content:"编辑",placement:"top"},{default:a(()=>[t(p,{size:"small",type:"warning",icon:c(R),onClick:v=>z(l)},null,8,["icon","onClick"])]),_:2},1024),t(b,{content:"删除",placement:"top"},{default:a(()=>[t(p,{size:"small",type:"danger",icon:c(A),onClick:v=>M(l)},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):m("",!0)])}}});const de=K(ne,[["__scopeId","data-v-a8f88d35"]]);export{de as default};
