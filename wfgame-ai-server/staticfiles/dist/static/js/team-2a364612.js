import{aQ as m,e as n,aR as r,aS as o,an as u,aE as T,s as l}from"./index-c3bc70ba.js";import{s as E,l as h,a as f}from"./team-dc58a0de.js";import{s as a}from"./request-6dd7bfdd.js";import{g as i}from"./enums-d2c4bc7a.js";const _=m(),p=n({id:"current-team",state:()=>({teamId:0,teamName:"未选择团队",teamFullNames:["未选择团队"],mineTeamOptions:[],allTeamOptions:[],refreshLoading:!1,animate:!1}),actions:{SET_TEAM_ID(e){this.teamId=e},SET_TEAM_NAME(e){this.teamName=e},SET_TEAM_FULL_NAMES(e){this.teamFullNames=e},GET_TEAM_FULL_NAMES(){var e;return(e=this.teamFullNames)==null?void 0:e.join(" • ")},SET_TEAM(e){this.teamId=e.id||0,this.teamName=e.name||"未选择团队",this.teamFullNames=e.full_name||["未选择团队"],e!=null&&e.perms&&(_.SET_PERMS(e.perms),r({perms:e.perms}))},GET_TEAM_GM_TYPE(){const e=this.GET_TEAM_FULL_NAMES();for(const s in i)if(e.includes(i[s].label))return i[s].value;return i.UNKNOWN.value},GET_MINE_TEAM_OPTIONS(){if(this.mineTeamOptions.length>0)return this.mineTeamOptions;this.refreshTeamOptions("mine")},async switchTeam(e=0,s=!0){await a({apiFunc:E,apiParams:{id:e},onSucceed:t=>{o(),this.SET_TEAM(t),this.animate=!0,setTimeout(()=>{this.animate=!1},1e3),e&&s&&(u(),T())}})},async refreshTeamOptions(e="mine",s){await a({apiFunc:e==="mine"?h:f,onBeforeRequest:()=>{this.refreshLoading=!0},onSucceed:t=>{e==="mine"?this.mineTeamList=t.data:this.allTeamList=t.data,typeof s=="function"&&s()},onCompleted:()=>{this.refreshLoading=!1}})}}});function A(){return p(l)}export{A as u};
