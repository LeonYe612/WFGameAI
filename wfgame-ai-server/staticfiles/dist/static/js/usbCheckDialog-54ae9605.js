import{j as V,n as T,x as A,y as E}from"./index-8ca571cf.js";import{c as H}from"./devices-fe5d6e0e.js";import{s as O}from"./request-d2ecd641.js";import{l as Q,r as y,z as n,N as $,h as a,q as v,H as s,k as t,y as o,A as f,v as x,O as G,j as i,x as d,Q as r,F as J,m as K,u as P,L as W,aF as X,ah as Y,ai as Z,_ as ee}from"./index-e046f3d2.js";const k=_=>(Y("data-v-e5717702"),_=_(),Z(),_),se={class:"usb-check-content"},te={key:0,class:"space-y-4"},ae={class:"flex items-center justify-between"},oe={class:"flex items-center"},le=k(()=>t("span",{class:"font-medium"},"检查结果",-1)),ce={key:0,class:"mb-4"},ne={class:"text-sm text-gray-600"},ie=k(()=>t("span",{class:"font-medium"},"设备详情",-1)),ue={class:"space-y-3"},de={class:"flex items-center space-x-3"},re={class:"font-medium"},_e={key:0,class:"text-sm text-gray-500"},pe={key:1,class:"text-center py-12"},me=k(()=>t("p",{class:"text-gray-500"},"正在检查USB连接...",-1)),ve={class:"flex justify-end space-x-2"},fe=Q({name:"UsbCheckDialog",__name:"usbCheckDialog",setup(_,{expose:z}){const p=y(!1),u=y(!1),e=y(null),j=()=>{e.value=null,p.value=!0,b()},b=async()=>{await O({apiFunc:H,enableSucceedMsg:!0,succeedMsgContent:"USB连接检查完成！",onBeforeRequest:()=>{u.value=!0},onSucceed:c=>{e.value=c},onFailed:()=>{X("USB连接检查失败",{type:"error"})},onCompleted:()=>{u.value=!1}})},C=()=>{p.value=!1,e.value=null},F=c=>c==="connected"?A:E,S=c=>c==="connected"?"success":"danger",I=c=>({connected:"已连接",disconnected:"未连接",unauthorized:"未授权",offline:"离线"})[c]||c;return z({showDialog:j}),(c,g)=>{const h=n("el-icon"),D=n("el-tag"),N=n("el-alert"),w=n("el-card"),M=n("el-empty"),B=n("el-button"),q=n("el-dialog"),L=$("loading");return a(),v(q,{modelValue:p.value,"onUpdate:modelValue":g[0]||(g[0]=m=>p.value=m),title:"USB连接检查",width:"600px",draggable:!0,onClose:C},{footer:s(()=>[t("div",ve,[o(B,{onClick:C},{default:s(()=>[f("关闭")]),_:1}),o(B,{type:"primary",icon:x(V),loading:u.value,onClick:b},{default:s(()=>[f(" 重新检查 ")]),_:1},8,["icon","loading"])])]),default:s(()=>{var m,U;return[G((a(),i("div",se,[!u.value&&e.value?(a(),i("div",te,[o(w,{shadow:"never",class:"border"},{header:s(()=>[t("div",ae,[t("div",oe,[o(h,{class:"mr-2"},{default:s(()=>[o(x(V))]),_:1}),le]),o(D,{type:e.value.success?"success":"danger",size:"large"},{default:s(()=>[f(d(e.value.success?"检查成功":"检查失败"),1)]),_:1},8,["type"])])]),default:s(()=>{var l;return[e.value.message?(a(),i("div",ce,[o(N,{title:e.value.message,type:e.value.success?"success":"error","show-icon":"",closable:!1},null,8,["title","type"])])):r("",!0),t("div",ne,[t("p",null,"检查时间: "+d(new Date().toLocaleString()),1),t("p",null,"发现设备: "+d(((l=e.value.devices)==null?void 0:l.length)||0)+" 台",1)])]}),_:1}),((m=e.value.devices)==null?void 0:m.length)>0?(a(),v(w,{key:0,shadow:"never",class:"border"},{header:s(()=>[ie]),default:s(()=>[t("div",ue,[(a(!0),i(J,null,K(e.value.devices,(l,R)=>(a(),i("div",{key:R,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",de,[o(h,{class:W(`text-${S(l.status)}`),size:"20"},{default:s(()=>[(a(),v(P(F(l.status))))]),_:2},1032,["class"]),t("div",null,[t("div",re,d(l.device_id),1),l.message?(a(),i("div",_e,d(l.message),1)):r("",!0)])]),o(D,{type:S(l.status),size:"small"},{default:s(()=>[f(d(I(l.status)),1)]),_:2},1032,["type"])]))),128))])]),_:1})):r("",!0),((U=e.value.devices)==null?void 0:U.length)===0?(a(),v(M,{key:1,description:"未发现USB连接的设备",class:"py-8"})):r("",!0)])):r("",!0),u.value?(a(),i("div",pe,[o(h,{class:"animate-spin text-4xl text-primary mb-4"},{default:s(()=>[o(x(T))]),_:1}),me])):r("",!0)])),[[L,u.value]])]}),_:1},8,["modelValue"])}}});const ke=ee(fe,[["__scopeId","data-v-e5717702"]]);export{ke as default};
