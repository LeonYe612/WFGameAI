import{l as J,r as m,o as K,w as P,z as i,N as W,h as r,q as u,H as n,y as o,A as k,O as X,v as a,k as g,Q as b,j as N,x as $,aF as Y,M as Z}from"./index-c3bc70ba.js";import{z as ee,a as te,r as ne,w as le}from"./index-52ed101c.js";import{F as oe}from"./file-27036f63.js";import{T as ae}from"./team-3cb80684.js";import{useSysTeamManagement as se}from"./hook-ba3a1950.js";const ie={class:"flex items-center"},re=g("span",null,"名称",-1),ce={class:"inline-flex items-center align-middle justify-start"},ue={key:0},de={key:1},_e={class:"flex items-center justify-center mt-4 text-gray-400"},fe=g("span",{class:"text-sm font-semibold ml-1"},"小贴士: 双击选项可以实现快速选择",-1),ye=J({name:"TeamSelector",__name:"index",props:{title:{type:String,default:"请选择团队："},scope:{type:String,default:"all"}},emits:["complete"],setup(B,{expose:j,emit:E}){const h=B,d=m(),x=m(),C=m(h.title),_=m(!1),v=m(),{dataList:w,loading:F,fetchData:z,toggleTableExpansion:R}=se({teamTableRef:v});K(()=>{z(h.scope)});const y=e=>{var t;(t=v.value)==null||t.setCurrentRow(e)},M=e=>{var t;if(e.genre!=2){(t=v.value)==null||t.toggleRowExpansion(e),y(x.value);return}},A=(e,t)=>{d.value=e,x.value=t};P(d,e=>{const t=e?e.name:"";C.value=`${h.title}${t}`});const T=(e,t)=>{const c=(e==null?void 0:e.length)||0;for(let f=0;f<c;f++){const s=e[f];if(s.id==t)return s;if(s.children&&s.children.length>0){const p=T(s.children,t);if(p)return p}}return null},D=e=>{if(y(),e){const t=T(w.value,e);t&&Z(()=>{y(t)})}},q=e=>{_.value=!0,D(e==null?void 0:e.id)},H=()=>{z(h.scope,()=>{var e;D((e=d.value)==null?void 0:e.id)})},I=()=>{_.value=!1},L=e=>{if(e.genre!=1&&e.genre==2){y(e),V();return}},V=()=>{if(!d.value){Y("尚未选择任何团队",{type:"error"});return}E("complete",d.value),_.value=!1};return j({show:q}),(e,t)=>{const c=i("el-button"),f=i("el-button-group"),s=i("el-icon"),p=i("el-table-column"),S=i("el-tag"),O=i("el-tooltip"),Q=i("el-table"),U=i("el-dialog"),G=W("loading");return r(),u(U,{modelValue:_.value,"onUpdate:modelValue":t[2]||(t[2]=l=>_.value=l),title:C.value,width:"25vw",draggable:!0,"align-center":"",class:"pt-2"},{footer:n(()=>[o(c,{onClick:I,size:"large"},{default:n(()=>[k("取 消")]),_:1}),o(c,{type:"primary",onClick:V,size:"large"},{default:n(()=>[k(" 确定 ")]),_:1})]),default:n(()=>[X((r(),u(Q,{class:"team-selector-table cursor-pointer select-none","empty-text":"您尚未加入任何团队",data:a(w),"default-expand-all":"","row-key":"id","max-height":"50vh",height:"44vh","tree-props":{children:"children"},ref_key:"teamTableRef",ref:v,"table-layout":"auto","highlight-current-row":"","current-row-key":"id",onRowClick:M,onRowDblclick:L,onCurrentChange:A},{default:n(()=>[o(p,{label:"名称",prop:"meta.title"},{header:n(()=>[g("div",ie,[re,o(f,{class:"ml-2"},{default:n(()=>[o(c,{title:"展开所有",type:"default",plain:"",size:"small",icon:a(ee),onClick:t[0]||(t[0]=l=>a(R)(!0))},null,8,["icon"]),o(c,{title:"合并所有",type:"default",plain:"",size:"small",icon:a(te),onClick:t[1]||(t[1]=l=>a(R)(!1))},null,8,["icon"]),o(c,{title:"刷新数据",type:"default",plain:"",size:"small",icon:a(ne),onClick:H},null,8,["icon"])]),_:1})])]),default:n(({row:l})=>[g("div",ce,[o(s,{size:22},{default:n(()=>[l.genre==1?(r(),u(a(oe),{key:0})):b("",!0),l.genre==2?(r(),u(a(ae),{key:1})):b("",!0)]),_:2},1024),o(s),l.genre==1?(r(),N("span",ue,$(l.name),1)):(r(),N("span",de,$(l.name),1))])]),_:1}),o(p,{align:"center",label:"类型"},{default:n(({row:l})=>[l.genre==1?(r(),u(S,{key:0,type:"warning",effect:"plain"},{default:n(()=>[k("目录")]),_:1})):b("",!0),l.genre==2?(r(),u(O,{key:1,effect:"light",content:`ID:${l.id}`,placement:"right"},{default:n(()=>[o(S,{effect:"plain"},{default:n(()=>[k("团队")]),_:1})]),_:2},1032,["content"])):b("",!0)]),_:1})]),_:1},8,["data"])),[[G,a(F)]]),g("div",_e,[o(s,{size:16},{default:n(()=>[o(a(le))]),_:1}),fe])]),_:1},8,["modelValue","title"])}}});export{ye as _};
