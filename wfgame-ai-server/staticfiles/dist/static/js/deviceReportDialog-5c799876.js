import{d as k,n as S}from"./index-ccf167da.js";import{g as I}from"./devices-d3e10ba4.js";import{s as j}from"./request-2aeceb02.js";import{m as q,r as v,A as i,O as E,j as d,u as F,I as a,l as t,z as o,B as m,x as g,P as M,k as u,y as c,R as _,aE as O,_ as P}from"./index-fbbdd03e.js";const z={class:"device-report-content"},A={key:0,class:"space-y-4"},J={class:"flex items-center"},T={class:"grid grid-cols-2 gap-4 text-sm"},U={key:0},$={key:1},h={class:"report-data"},G={class:"bg-gray-50 p-4 rounded-lg text-sm overflow-auto max-h-96"},H={key:1,class:"text-center py-12"},K={class:"flex justify-end space-x-2"},L=q({name:"DeviceReportDialog",__name:"deviceReportDialog",setup(Q,{expose:C}){const p=v(!1),n=v(!1),s=v(null),l=v(null),R=r=>{s.value=r||null,l.value=null,p.value=!0,f()},f=async()=>{var r;await j({apiFunc:I,apiParams:(r=s.value)==null?void 0:r.device_id,enableSucceedMsg:!0,succeedMsgContent:"设备报告生成成功！",onBeforeRequest:()=>{n.value=!0},onSucceed:e=>{l.value=e},onFailed:()=>{O("生成设备报告失败",{type:"error"})},onCompleted:()=>{n.value=!1}})},y=()=>{p.value=!1,s.value=null,l.value=null};return C({showDialog:R}),(r,e)=>{const x=i("el-icon"),w=i("el-tag"),D=i("el-card"),b=i("el-button"),V=i("el-dialog"),B=E("loading");return d(),F(V,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=N=>p.value=N),title:s.value?`${s.value.device_id} 设备报告`:"全设备报告",width:"800px",draggable:!0,onClose:y},{footer:a(()=>[t("div",K,[o(b,{onClick:y},{default:a(()=>[...e[8]||(e[8]=[m("关闭",-1)])]),_:1}),o(b,{type:"primary",icon:g(k),loading:n.value,onClick:f},{default:a(()=>[...e[9]||(e[9]=[m(" 重新生成 ",-1)])]),_:1},8,["icon","loading"])])]),default:a(()=>[M((d(),u("div",z,[!n.value&&l.value?(d(),u("div",A,[o(D,{shadow:"never",class:"border"},{header:a(()=>[t("div",J,[o(x,{class:"mr-2"},{default:a(()=>[o(g(k))]),_:1}),e[1]||(e[1]=t("span",{class:"font-medium"},"报告信息",-1))])]),default:a(()=>[t("div",T,[t("div",null,[e[2]||(e[2]=t("span",{class:"text-gray-500"},"设备ID: ",-1)),o(w,{type:"info"},{default:a(()=>[m(c(l.value.device_id),1)]),_:1})]),t("div",null,[e[3]||(e[3]=t("span",{class:"text-gray-500"},"生成时间: ",-1)),t("span",null,c(l.value.generated_at),1)]),s.value?(d(),u("div",U,[e[4]||(e[4]=t("span",{class:"text-gray-500"},"设备品牌: ",-1)),t("span",null,c(s.value.brand||"-"),1)])):_("",!0),s.value?(d(),u("div",$,[e[5]||(e[5]=t("span",{class:"text-gray-500"},"设备型号: ",-1)),t("span",null,c(s.value.model||"-"),1)])):_("",!0)])]),_:1}),o(D,{shadow:"never",class:"border"},{header:a(()=>[...e[6]||(e[6]=[t("span",{class:"font-medium"},"报告详情",-1)])]),default:a(()=>[t("div",h,[t("pre",G,c(typeof l.value.report_data=="string"?l.value.report_data:JSON.stringify(l.value.report_data,null,2)),1)])]),_:1})])):_("",!0),n.value?(d(),u("div",H,[o(x,{class:"animate-spin text-4xl text-primary mb-4"},{default:a(()=>[o(g(S))]),_:1}),e[7]||(e[7]=t("p",{class:"text-gray-500"},"正在生成设备报告...",-1))])):_("",!0)])),[[B,n.value]])]),_:1},8,["modelValue","title"])}}});const ee=P(L,[["__scopeId","data-v-d2a6d016"]]);export{ee as default};
