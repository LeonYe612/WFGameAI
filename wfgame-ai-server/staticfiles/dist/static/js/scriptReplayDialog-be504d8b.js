import{I as U,p as Q,m as T}from"./index-8ca571cf.js";import{r as G}from"./scripts-e54598c6.js";import{s as J}from"./request-d2ecd641.js";import{l as K,r as v,c as W,z as c,N as X,h as u,q as h,H as l,k as e,y as n,A as p,x as y,v as x,O as Y,j as V,F as R,m as j,Q as N,aF as B,ah as Z,ai as ee,_ as le}from"./index-e046f3d2.js";const _=b=>(Z("data-v-0ad850fa"),b=b(),ee(),b),ae={class:"script-replay-content"},te={class:"space-y-4"},se={class:"flex items-center justify-between"},oe={class:"flex items-center"},ne=_(()=>e("span",{class:"font-medium"},"回放配置",-1)),de={class:"space-y-4"},ie={class:"flex items-center justify-between mb-3"},ce={class:"font-medium text-gray-700"},re={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ue=_(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 选择脚本 * ",-1)),me={class:"flex justify-between items-center"},pe=_(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 延迟时间 (毫秒) ",-1)),_e=_(()=>e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 循环次数 ",-1)),fe={class:"mt-6 p-4 bg-blue-50 rounded-lg"},ve=_(()=>e("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"全局设置",-1)),ye={class:"flex items-center space-x-4"},be=_(()=>e("span",{class:"font-medium"},"命令预览",-1)),ge={class:"bg-gray-100 p-3 rounded-lg font-mono text-sm"},he={class:"flex justify-end space-x-2"},xe=K({name:"ScriptReplayDialog",__name:"scriptReplayDialog",props:{scripts:{}},setup(b,{expose:F}){const g=v(!1),o=v(!1),C=v(null),f=v(!0),d=v([]),I=a=>{C.value=a||null,a?d.value=[{script_filename:a.filename,delay:0,loop:1}]:d.value=[{script_filename:"",delay:0,loop:1}],g.value=!0},$=()=>{d.value.push({script_filename:"",delay:0,loop:1})},z=a=>{d.value.length>1&&d.value.splice(a,1)},q=W(()=>{const a=d.value.filter(t=>t.script_filename);return a.length===0?"请先选择要回放的脚本":`回放脚本: ${a.map(t=>{let r=t.script_filename;return t.delay&&t.delay>0&&(r+=` (延迟: ${t.delay}ms)`),t.loop&&t.loop>1&&(r+=` (循环: ${t.loop}次)`),r}).join(", ")}${f.value?" --show-screens":""}`}),M=async()=>{const a=d.value.filter(t=>t.script_filename);if(a.length===0){B("请至少选择一个脚本进行回放",{type:"warning"});return}const m={scripts:a,show_screens:f.value};await J({apiFunc:G,apiParams:m,enableSucceedMsg:!0,succeedMsgContent:"脚本回放已开始执行！",onBeforeRequest:()=>{o.value=!0},onSucceed:()=>{w()},onFailed:()=>{B("脚本回放启动失败",{type:"error"})},onCompleted:()=>{o.value=!1}})},w=()=>{g.value=!1,C.value=null,d.value=[],f.value=!0};return F({showDialog:I}),(a,m)=>{const t=c("el-icon"),r=c("el-button"),P=c("el-tag"),A=c("el-option"),E=c("el-select"),S=c("el-input-number"),H=c("el-checkbox"),D=c("el-card"),L=c("el-dialog"),O=X("loading");return u(),h(L,{modelValue:g.value,"onUpdate:modelValue":m[1]||(m[1]=i=>g.value=i),title:"脚本回放",width:"800px",draggable:!0,onClose:w},{footer:l(()=>[e("div",he,[n(r,{onClick:w,disabled:o.value},{default:l(()=>[p(" 取消 ")]),_:1},8,["disabled"]),n(r,{type:"primary",icon:x(U),loading:o.value,onClick:M},{default:l(()=>[p(y(o.value?"启动中...":"开始回放"),1)]),_:1},8,["icon","loading"])])]),default:l(()=>[Y((u(),V("div",ae,[e("div",te,[n(D,{shadow:"never",class:"border"},{header:l(()=>[e("div",se,[e("div",oe,[n(t,{class:"mr-2"},{default:l(()=>[n(x(U))]),_:1}),ne]),n(r,{size:"small",type:"primary",icon:x(Q),onClick:$,disabled:o.value},{default:l(()=>[p(" 添加脚本 ")]),_:1},8,["icon","disabled"])])]),default:l(()=>[e("div",de,[(u(!0),V(R,null,j(d.value,(i,k)=>(u(),V("div",{key:k,class:"script-config p-4 bg-gray-50 rounded-lg"},[e("div",ie,[e("span",ce,"脚本 "+y(k+1),1),d.value.length>1?(u(),h(r,{key:0,size:"small",type:"danger",icon:x(T),onClick:s=>z(k),disabled:o.value},{default:l(()=>[p(" 移除 ")]),_:2},1032,["icon","onClick","disabled"])):N("",!0)]),e("div",re,[e("div",null,[ue,n(E,{modelValue:i.script_filename,"onUpdate:modelValue":s=>i.script_filename=s,placeholder:"请选择脚本",style:{width:"100%"},filterable:"",disabled:o.value},{default:l(()=>[(u(!0),V(R,null,j(a.scripts,s=>(u(),h(A,{key:s.filename,label:s.filename,value:s.filename},{default:l(()=>[e("div",me,[e("span",null,y(s.filename),1),s.category?(u(),h(P,{key:0,type:"info",size:"small"},{default:l(()=>[p(y(s.category),1)]),_:2},1024)):N("",!0)])]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),e("div",null,[pe,n(S,{modelValue:i.delay,"onUpdate:modelValue":s=>i.delay=s,min:0,max:1e4,style:{width:"100%"},disabled:o.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e("div",null,[_e,n(S,{modelValue:i.loop,"onUpdate:modelValue":s=>i.loop=s,min:1,max:100,style:{width:"100%"},disabled:o.value},null,8,["modelValue","onUpdate:modelValue","disabled"])])])]))),128))]),e("div",fe,[ve,e("div",ye,[n(H,{modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=i=>f.value=i),disabled:o.value},{default:l(()=>[p(" 显示屏幕截图 ")]),_:1},8,["modelValue","disabled"])])])]),_:1}),n(D,{shadow:"never",class:"border"},{header:l(()=>[be]),default:l(()=>[e("div",ge,y(q.value),1)]),_:1})])])),[[O,o.value]])]),_:1},8,["modelValue"])}}});const Se=le(xe,[["__scopeId","data-v-0ad850fa"]]);export{Se as default};
