import{g as ae,o as ne,q as ie,r as A,p as de,u as re,d as K,l as H,I as G,K as J,L as O,m as P,M as ce}from"./index-8ca571cf.js";import ue from"./scriptEditDialog-d7764ca3.js";import pe from"./scriptReplayDialog-be504d8b.js";import{l as _e,r as L,c as fe,z as u,h as r,j as m,k as a,y as l,v as i,H as s,F as W,m as X,q as k,A as n,x as c,Q as b,ah as me,ai as ye,_ as ge}from"./index-e046f3d2.js";import"./scripts-e54598c6.js";import"./request-d2ecd641.js";const w=C=>(me("data-v-a96b141a"),C=C(),ye(),C),ve={class:"w-full h-full bg-red-200"},he={key:0,class:"flex items-center justify-between mb-4"},be={class:"flex items-center space-x-4"},ke={class:"flex items-center space-x-2"},we={key:1,class:"text-center py-12"},Ce=w(()=>a("p",{class:"text-gray-500"},"正在加载脚本列表...",-1)),xe={key:3,class:"text-center py-12"},ze={class:"space-y-4"},Fe=w(()=>a("p",{class:"text-gray-500"}," 还没有任何脚本，开始创建你的第一个脚本吧！ ",-1)),Se={class:"flex justify-center space-x-4"},$e={class:"flex items-center"},Le={class:"font-medium"},De={key:1,class:"text-gray-400"},Ve={class:"flex space-x-1"},Ie={key:5,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Me={class:"flex items-center justify-between"},Be={class:"flex items-center"},je={class:"font-medium truncate"},Te={class:"space-y-2 text-sm"},Re={class:"flex justify-between"},qe=w(()=>a("span",{class:"text-gray-500"},"分类:",-1)),Qe={key:1},Ne={class:"flex justify-between"},Ue=w(()=>a("span",{class:"text-gray-500"},"大小:",-1)),Ee={class:"flex justify-between"},Ae=w(()=>a("span",{class:"text-gray-500"},"修改时间:",-1)),Ke={key:0,class:"pt-2 border-t"},He=w(()=>a("span",{class:"text-gray-500"},"描述:",-1)),Ge={class:"mt-1 text-sm text-gray-700 line-clamp-2"},Je={class:"flex justify-between space-x-1"},Oe=_e({name:"ScriptsTable",__name:"scriptsTable",props:{scripts:{},categories:{},loading:{type:Boolean},error:{},stats:{},searchQuery:{},categoryFilter:{},typeFilter:{},includeInLogFilter:{},viewMode:{},filteredSortedScripts:{}},emits:["edit","replay","copy","delete","toggle-log","refresh","create","import","update:search-query","update:category-filter","update:type-filter","update:include-in-log-filter","update:view-mode"],setup(C,{emit:p}){const _=C,V=L(),I=L(),x=L("filename"),z=L("asc"),M=e=>e?"已加入日志":"未加入日志",B=e=>e?"success":"warning",F=e=>{x.value===e?z.value=z.value==="asc"?"desc":"asc":(x.value=e,z.value="asc")},j=fe(()=>{let e=_.scripts;if(_.searchQuery){const o=_.searchQuery.toLowerCase();e=e.filter(y=>{var f,v,d;return((f=y.filename)==null?void 0:f.toLowerCase().includes(o))||((v=y.category)==null?void 0:v.toLowerCase().includes(o))||((d=y.description)==null?void 0:d.toLowerCase().includes(o))})}if(_.categoryFilter&&(e=e.filter(o=>o.category===_.categoryFilter)),_.typeFilter&&(e=e.filter(o=>o.script_type===_.typeFilter)),_.includeInLogFilter!==""){const o=_.includeInLogFilter==="true";e=e.filter(y=>y.include_in_log===o)}return x.value&&(e=[...e].sort((o,y)=>{const f=o[x.value]||"",v=y[x.value]||"",d=f.toString().localeCompare(v.toString());return z.value==="asc"?d:-d})),e}),T=e=>{var o;(o=V.value)==null||o.showDialog(e)},R=e=>{var o;(o=I.value)==null||o.showDialog(e)},q=e=>{p("copy",e.filename)},Q=e=>{p("delete",e.filename)},N=e=>{p("toggle-log",e.filename,!e.include_in_log)},Y=()=>{const e=_.viewMode==="table"?"card":"table";p("update:view-mode",e)},U=e=>e<1024?e+" B":e<1024*1024?(e/1024).toFixed(2)+" KB":(e/(1024*1024)).toFixed(2)+" MB",E=e=>e?new Date(e).toLocaleDateString():"-";return(e,o)=>{const y=u("el-input"),f=u("el-option"),v=u("el-select"),d=u("el-button"),S=u("el-icon"),Z=u("el-alert"),ee=u("el-empty"),h=u("el-table-column"),$=u("el-tag"),te=u("el-table"),D=u("el-dropdown-item"),le=u("el-dropdown-menu"),oe=u("el-dropdown"),se=u("el-card");return r(),m("div",ve,[!e.loading&&e.scripts.length>0?(r(),m("div",he,[a("div",be,[l(y,{"model-value":e.searchQuery,"onUpdate:modelValue":o[0]||(o[0]=t=>p("update:search-query",t)),placeholder:"搜索脚本名称、分类、描述...","prefix-icon":i(ae),style:{width:"300px"},clearable:""},null,8,["model-value","prefix-icon"]),l(v,{"model-value":e.categoryFilter,"onUpdate:modelValue":o[1]||(o[1]=t=>p("update:category-filter",t)),placeholder:"所有分类",style:{width:"150px"},clearable:""},{default:s(()=>[(r(!0),m(W,null,X(e.categories,t=>(r(),k(f,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["model-value"]),l(v,{"model-value":e.typeFilter,"onUpdate:modelValue":o[2]||(o[2]=t=>p("update:type-filter",t)),placeholder:"所有类型",style:{width:"150px"},clearable:""},{default:s(()=>[l(f,{label:"录制脚本",value:"recorded"}),l(f,{label:"手动脚本",value:"manual"})]),_:1},8,["model-value"]),l(v,{"model-value":e.includeInLogFilter,"onUpdate:modelValue":o[3]||(o[3]=t=>p("update:include-in-log-filter",t)),placeholder:"日志状态",style:{width:"150px"},clearable:""},{default:s(()=>[l(f,{label:"已加入日志",value:"true"}),l(f,{label:"未加入日志",value:"false"})]),_:1},8,["model-value"])]),a("div",ke,[l(d,{icon:e.viewMode==="table"?i(ne):i(ie),onClick:Y},{default:s(()=>[n(c(e.viewMode==="table"?"卡片视图":"表格视图"),1)]),_:1},8,["icon"]),l(d,{icon:i(A),type:"primary",onClick:o[4]||(o[4]=t=>p("refresh"))},{default:s(()=>[n(" 刷新 ")]),_:1},8,["icon"])])])):b("",!0),e.loading?(r(),m("div",we,[l(S,{class:"animate-spin text-4xl text-primary mb-4"},{default:s(()=>[l(i(A))]),_:1}),Ce])):b("",!0),e.error?(r(),k(Z,{key:2,title:e.error,type:"error",class:"mb-4","show-icon":""},null,8,["title"])):b("",!0),!e.loading&&e.scripts.length===0?(r(),m("div",xe,[l(ee,{description:"暂无脚本"},{default:s(()=>[a("div",ze,[Fe,a("div",Se,[l(d,{type:"primary",icon:i(de),onClick:o[5]||(o[5]=t=>p("create"))},{default:s(()=>[n(" 新建脚本 ")]),_:1},8,["icon"]),l(d,{type:"success",icon:i(re),onClick:o[6]||(o[6]=t=>p("import"))},{default:s(()=>[n(" 导入脚本 ")]),_:1},8,["icon"])])])]),_:1})])):b("",!0),!e.loading&&e.scripts.length>0&&e.viewMode==="table"?(r(),k(te,{key:4,data:j.value,stripe:"",style:{width:"100%"},class:"scripts-table"},{default:s(()=>[l(h,{prop:"filename",label:"脚本名称","min-width":"180",sortable:"",onClick:o[7]||(o[7]=t=>F("filename"))},{default:s(({row:t})=>[a("div",$e,[l(S,{class:"mr-2 text-primary"},{default:s(()=>[l(i(K))]),_:1}),a("span",Le,c(t.filename),1)])]),_:1}),l(h,{prop:"category",label:"分类",width:"120",sortable:"",onClick:o[8]||(o[8]=t=>F("category"))},{default:s(({row:t})=>[t.category?(r(),k($,{key:0,type:"info",size:"small"},{default:s(()=>[n(c(t.category),1)]),_:2},1024)):(r(),m("span",De,"-"))]),_:1}),l(h,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""},{default:s(({row:t})=>[n(c(t.description||"-"),1)]),_:1}),l(h,{prop:"size",label:"文件大小",width:"100",sortable:"",onClick:o[9]||(o[9]=t=>F("size"))},{default:s(({row:t})=>[n(c(t.size?U(t.size):"-"),1)]),_:1}),l(h,{prop:"include_in_log",label:"日志状态",width:"120",sortable:"",onClick:o[10]||(o[10]=t=>F("include_in_log"))},{default:s(({row:t})=>[l($,{type:B(t.include_in_log),size:"small"},{default:s(()=>[n(c(M(t.include_in_log)),1)]),_:2},1032,["type"])]),_:1}),l(h,{prop:"modified_at",label:"修改时间",width:"120"},{default:s(({row:t})=>[n(c(E(t.modified_at)),1)]),_:1}),l(h,{label:"操作",width:"280",fixed:"right"},{default:s(({row:t})=>[a("div",Ve,[l(d,{size:"small",type:"primary",icon:i(H),onClick:g=>T(t)},{default:s(()=>[n(" 编辑 ")]),_:2},1032,["icon","onClick"]),l(d,{size:"small",type:"success",icon:i(G),onClick:g=>R(t)},{default:s(()=>[n(" 回放 ")]),_:2},1032,["icon","onClick"]),l(d,{size:"small",type:"info",icon:i(J),onClick:g=>q(t)},{default:s(()=>[n(" 复制 ")]),_:2},1032,["icon","onClick"]),l(d,{size:"small",type:t.include_in_log?"warning":"success",icon:i(O),onClick:g=>N(t)},{default:s(()=>[n(c(t.include_in_log?"移出":"加入")+"日志 ",1)]),_:2},1032,["type","icon","onClick"]),l(d,{size:"small",type:"danger",icon:i(P),onClick:g=>Q(t)},{default:s(()=>[n(" 删除 ")]),_:2},1032,["icon","onClick"])])]),_:1})]),_:1},8,["data"])):b("",!0),!e.loading&&e.scripts.length>0&&e.viewMode==="card"?(r(),m("div",Ie,[(r(!0),m(W,null,X(j.value,t=>(r(),k(se,{key:t.id||t.filename,shadow:"hover",class:"script-card"},{header:s(()=>[a("div",Me,[a("div",Be,[l(S,{class:"mr-2 text-primary"},{default:s(()=>[l(i(K))]),_:1}),a("span",je,c(t.filename),1)]),l($,{type:B(t.include_in_log),size:"small"},{default:s(()=>[n(c(M(t.include_in_log)),1)]),_:2},1032,["type"])])]),footer:s(()=>[a("div",Je,[l(d,{size:"small",type:"primary",icon:i(H),onClick:g=>T(t)},{default:s(()=>[n(" 编辑 ")]),_:2},1032,["icon","onClick"]),l(d,{size:"small",type:"success",icon:i(G),onClick:g=>R(t)},{default:s(()=>[n(" 回放 ")]),_:2},1032,["icon","onClick"]),l(oe,{trigger:"click"},{dropdown:s(()=>[l(le,null,{default:s(()=>[l(D,{icon:i(J),onClick:g=>q(t)},{default:s(()=>[n(" 复制脚本 ")]),_:2},1032,["icon","onClick"]),l(D,{icon:i(O),onClick:g=>N(t)},{default:s(()=>[n(c(t.include_in_log?"移出":"加入")+"日志 ",1)]),_:2},1032,["icon","onClick"]),l(D,{icon:i(P),onClick:g=>Q(t),divided:""},{default:s(()=>[n(" 删除脚本 ")]),_:2},1032,["icon","onClick"])]),_:2},1024)]),default:s(()=>[l(d,{size:"small",type:"info"},{default:s(()=>[n(" 更多 "),l(S,{class:"ml-1"},{default:s(()=>[l(i(ce))]),_:1})]),_:1})]),_:2},1024)])]),default:s(()=>[a("div",Te,[a("div",Re,[qe,t.category?(r(),k($,{key:0,type:"info",size:"small"},{default:s(()=>[n(c(t.category),1)]),_:2},1024)):(r(),m("span",Qe,"-"))]),a("div",Ne,[Ue,a("span",null,c(t.size?U(t.size):"-"),1)]),a("div",Ee,[Ae,a("span",null,c(E(t.modified_at)),1)]),t.description?(r(),m("div",Ke,[He,a("p",Ge,c(t.description),1)])):b("",!0)])]),_:2},1024))),128))])):b("",!0),l(ue,{ref_key:"editDialogRef",ref:V,onSaved:o[11]||(o[11]=t=>p("refresh"))},null,512),l(pe,{ref_key:"replayDialogRef",ref:I,scripts:e.scripts},null,8,["scripts"])])}}});const tt=ge(Oe,[["__scopeId","data-v-a96b141a"]]);export{tt as default};
