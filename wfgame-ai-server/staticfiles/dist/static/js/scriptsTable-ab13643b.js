import{g as se,o as ie,q as ae,r as U,p as de,u as re,d as E,l as A,J,L as K,M as G,m as H,B as ue}from"./index-ccf167da.js";import pe from"./scriptEditDialog-4ce7e63c.js";import ce from"./scriptReplayDialog-f9448805.js";import{m as fe,r as L,d as me,A as p,j as r,k as _,l as s,z as o,x as a,I as n,F as O,p as P,u as w,B as i,y as u,R as b,_ as _e}from"./index-fbbdd03e.js";import"./scripts-d29b0ea0.js";import"./request-2aeceb02.js";const ye={class:"w-full h-full bg-red-200"},ge={key:0,class:"flex items-center justify-between mb-4"},ve={class:"flex items-center space-x-4"},ke={class:"flex items-center space-x-2"},be={key:1,class:"text-center py-12"},we={key:3,class:"text-center py-12"},Ce={class:"space-y-4"},xe={class:"flex justify-center space-x-4"},ze={class:"flex items-center"},Fe={class:"font-medium"},$e={key:1,class:"text-gray-400"},Le={class:"flex space-x-1"},Se={key:5,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},De={class:"flex items-center justify-between"},he={class:"flex items-center"},Be={class:"font-medium truncate"},Ve={class:"space-y-2 text-sm"},Me={class:"flex justify-between"},je={key:1},Te={class:"flex justify-between"},Ie={class:"flex justify-between"},Re={key:0,class:"pt-2 border-t"},qe={class:"mt-1 text-sm text-gray-700 line-clamp-2"},Ne={class:"flex justify-between space-x-1"},Qe=fe({name:"ScriptsTable",__name:"scriptsTable",props:{scripts:{},categories:{},loading:{type:Boolean},error:{},stats:{},searchQuery:{},categoryFilter:{},typeFilter:{},includeInLogFilter:{},viewMode:{},filteredSortedScripts:{}},emits:["edit","replay","copy","delete","toggle-log","refresh","create","import","update:search-query","update:category-filter","update:type-filter","update:include-in-log-filter","update:view-mode"],setup(W,{emit:X}){const f=W,c=X,D=L(),h=L(),C=L("filename"),x=L("asc"),B=t=>t?"已加入日志":"未加入日志",V=t=>t?"success":"warning",z=t=>{C.value===t?x.value=x.value==="asc"?"desc":"asc":(C.value=t,x.value="asc")},M=me(()=>{let t=f.scripts;if(f.searchQuery){const e=f.searchQuery.toLowerCase();t=t.filter(y=>{var m,v,d;return((m=y.filename)==null?void 0:m.toLowerCase().includes(e))||((v=y.category)==null?void 0:v.toLowerCase().includes(e))||((d=y.description)==null?void 0:d.toLowerCase().includes(e))})}if(f.categoryFilter&&(t=t.filter(e=>e.category===f.categoryFilter)),f.typeFilter&&(t=t.filter(e=>e.script_type===f.typeFilter)),f.includeInLogFilter!==""){const e=f.includeInLogFilter==="true";t=t.filter(y=>y.include_in_log===e)}return C.value&&(t=[...t].sort((e,y)=>{const m=e[C.value]||"",v=y[C.value]||"",d=m.toString().localeCompare(v.toString());return x.value==="asc"?d:-d})),t}),j=t=>{var e;(e=D.value)==null||e.showDialog(t)},T=t=>{var e;(e=h.value)==null||e.showDialog(t)},I=t=>{c("copy",t.filename)},R=t=>{c("delete",t.filename)},q=t=>{c("toggle-log",t.filename,!t.include_in_log)},Y=()=>{const t=f.viewMode==="table"?"card":"table";c("update:view-mode",t)},N=t=>t<1024?t+" B":t<1024*1024?(t/1024).toFixed(2)+" KB":(t/(1024*1024)).toFixed(2)+" MB",Q=t=>t?new Date(t).toLocaleDateString():"-";return(t,e)=>{const y=p("el-input"),m=p("el-option"),v=p("el-select"),d=p("el-button"),F=p("el-icon"),Z=p("el-alert"),ee=p("el-empty"),k=p("el-table-column"),$=p("el-tag"),te=p("el-table"),S=p("el-dropdown-item"),le=p("el-dropdown-menu"),oe=p("el-dropdown"),ne=p("el-card");return r(),_("div",ye,[!t.loading&&t.scripts.length>0?(r(),_("div",ge,[s("div",ve,[o(y,{"model-value":t.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=l=>c("update:search-query",l)),placeholder:"搜索脚本名称、分类、描述...","prefix-icon":a(se),style:{width:"300px"},clearable:""},null,8,["model-value","prefix-icon"]),o(v,{"model-value":t.categoryFilter,"onUpdate:modelValue":e[1]||(e[1]=l=>c("update:category-filter",l)),placeholder:"所有分类",style:{width:"150px"},clearable:""},{default:n(()=>[(r(!0),_(O,null,P(t.categories,l=>(r(),w(m,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["model-value"]),o(v,{"model-value":t.typeFilter,"onUpdate:modelValue":e[2]||(e[2]=l=>c("update:type-filter",l)),placeholder:"所有类型",style:{width:"150px"},clearable:""},{default:n(()=>[o(m,{label:"录制脚本",value:"recorded"}),o(m,{label:"手动脚本",value:"manual"})]),_:1},8,["model-value"]),o(v,{"model-value":t.includeInLogFilter,"onUpdate:modelValue":e[3]||(e[3]=l=>c("update:include-in-log-filter",l)),placeholder:"日志状态",style:{width:"150px"},clearable:""},{default:n(()=>[o(m,{label:"已加入日志",value:"true"}),o(m,{label:"未加入日志",value:"false"})]),_:1},8,["model-value"])]),s("div",ke,[o(d,{icon:t.viewMode==="table"?a(ie):a(ae),onClick:Y},{default:n(()=>[i(u(t.viewMode==="table"?"卡片视图":"表格视图"),1)]),_:1},8,["icon"]),o(d,{icon:a(U),type:"primary",onClick:e[4]||(e[4]=l=>c("refresh"))},{default:n(()=>[...e[12]||(e[12]=[i(" 刷新 ",-1)])]),_:1},8,["icon"])])])):b("",!0),t.loading?(r(),_("div",be,[o(F,{class:"animate-spin text-4xl text-primary mb-4"},{default:n(()=>[o(a(U))]),_:1}),e[13]||(e[13]=s("p",{class:"text-gray-500"},"正在加载脚本列表...",-1))])):b("",!0),t.error?(r(),w(Z,{key:2,title:t.error,type:"error",class:"mb-4","show-icon":""},null,8,["title"])):b("",!0),!t.loading&&t.scripts.length===0?(r(),_("div",we,[o(ee,{description:"暂无脚本"},{default:n(()=>[s("div",Ce,[e[16]||(e[16]=s("p",{class:"text-gray-500"}," 还没有任何脚本，开始创建你的第一个脚本吧！ ",-1)),s("div",xe,[o(d,{type:"primary",icon:a(de),onClick:e[5]||(e[5]=l=>c("create"))},{default:n(()=>[...e[14]||(e[14]=[i(" 新建脚本 ",-1)])]),_:1},8,["icon"]),o(d,{type:"success",icon:a(re),onClick:e[6]||(e[6]=l=>c("import"))},{default:n(()=>[...e[15]||(e[15]=[i(" 导入脚本 ",-1)])]),_:1},8,["icon"])])])]),_:1})])):b("",!0),!t.loading&&t.scripts.length>0&&t.viewMode==="table"?(r(),w(te,{key:4,data:M.value,stripe:"",style:{width:"100%"},class:"scripts-table"},{default:n(()=>[o(k,{prop:"filename",label:"脚本名称","min-width":"180",sortable:"",onClick:e[7]||(e[7]=l=>z("filename"))},{default:n(({row:l})=>[s("div",ze,[o(F,{class:"mr-2 text-primary"},{default:n(()=>[o(a(E))]),_:1}),s("span",Fe,u(l.filename),1)])]),_:1}),o(k,{prop:"category",label:"分类",width:"120",sortable:"",onClick:e[8]||(e[8]=l=>z("category"))},{default:n(({row:l})=>[l.category?(r(),w($,{key:0,type:"info",size:"small"},{default:n(()=>[i(u(l.category),1)]),_:2},1024)):(r(),_("span",$e,"-"))]),_:1}),o(k,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""},{default:n(({row:l})=>[i(u(l.description||"-"),1)]),_:1}),o(k,{prop:"size",label:"文件大小",width:"100",sortable:"",onClick:e[9]||(e[9]=l=>z("size"))},{default:n(({row:l})=>[i(u(l.size?N(l.size):"-"),1)]),_:1}),o(k,{prop:"include_in_log",label:"日志状态",width:"120",sortable:"",onClick:e[10]||(e[10]=l=>z("include_in_log"))},{default:n(({row:l})=>[o($,{type:V(l.include_in_log),size:"small"},{default:n(()=>[i(u(B(l.include_in_log)),1)]),_:2},1032,["type"])]),_:1}),o(k,{prop:"modified_at",label:"修改时间",width:"120"},{default:n(({row:l})=>[i(u(Q(l.modified_at)),1)]),_:1}),o(k,{label:"操作",width:"280",fixed:"right"},{default:n(({row:l})=>[s("div",Le,[o(d,{size:"small",type:"primary",icon:a(A),onClick:g=>j(l)},{default:n(()=>[...e[17]||(e[17]=[i(" 编辑 ",-1)])]),_:1},8,["icon","onClick"]),o(d,{size:"small",type:"success",icon:a(J),onClick:g=>T(l)},{default:n(()=>[...e[18]||(e[18]=[i(" 回放 ",-1)])]),_:1},8,["icon","onClick"]),o(d,{size:"small",type:"info",icon:a(K),onClick:g=>I(l)},{default:n(()=>[...e[19]||(e[19]=[i(" 复制 ",-1)])]),_:1},8,["icon","onClick"]),o(d,{size:"small",type:l.include_in_log?"warning":"success",icon:a(G),onClick:g=>q(l)},{default:n(()=>[i(u(l.include_in_log?"移出":"加入")+"日志 ",1)]),_:2},1032,["type","icon","onClick"]),o(d,{size:"small",type:"danger",icon:a(H),onClick:g=>R(l)},{default:n(()=>[...e[20]||(e[20]=[i(" 删除 ",-1)])]),_:1},8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])):b("",!0),!t.loading&&t.scripts.length>0&&t.viewMode==="card"?(r(),_("div",Se,[(r(!0),_(O,null,P(M.value,l=>(r(),w(ne,{key:l.id||l.filename,shadow:"hover",class:"script-card"},{header:n(()=>[s("div",De,[s("div",he,[o(F,{class:"mr-2 text-primary"},{default:n(()=>[o(a(E))]),_:1}),s("span",Be,u(l.filename),1)]),o($,{type:V(l.include_in_log),size:"small"},{default:n(()=>[i(u(B(l.include_in_log)),1)]),_:2},1032,["type"])])]),footer:n(()=>[s("div",Ne,[o(d,{size:"small",type:"primary",icon:a(A),onClick:g=>j(l)},{default:n(()=>[...e[25]||(e[25]=[i(" 编辑 ",-1)])]),_:1},8,["icon","onClick"]),o(d,{size:"small",type:"success",icon:a(J),onClick:g=>T(l)},{default:n(()=>[...e[26]||(e[26]=[i(" 回放 ",-1)])]),_:1},8,["icon","onClick"]),o(oe,{trigger:"click"},{dropdown:n(()=>[o(le,null,{default:n(()=>[o(S,{icon:a(K),onClick:g=>I(l)},{default:n(()=>[...e[28]||(e[28]=[i(" 复制脚本 ",-1)])]),_:1},8,["icon","onClick"]),o(S,{icon:a(G),onClick:g=>q(l)},{default:n(()=>[i(u(l.include_in_log?"移出":"加入")+"日志 ",1)]),_:2},1032,["icon","onClick"]),o(S,{icon:a(H),onClick:g=>R(l),divided:""},{default:n(()=>[...e[29]||(e[29]=[i(" 删除脚本 ",-1)])]),_:1},8,["icon","onClick"])]),_:2},1024)]),default:n(()=>[o(d,{size:"small",type:"info"},{default:n(()=>[e[27]||(e[27]=i(" 更多 ",-1)),o(F,{class:"ml-1"},{default:n(()=>[o(a(ue))]),_:1})]),_:1})]),_:2},1024)])]),default:n(()=>[s("div",Ve,[s("div",Me,[e[21]||(e[21]=s("span",{class:"text-gray-500"},"分类:",-1)),l.category?(r(),w($,{key:0,type:"info",size:"small"},{default:n(()=>[i(u(l.category),1)]),_:2},1024)):(r(),_("span",je,"-"))]),s("div",Te,[e[22]||(e[22]=s("span",{class:"text-gray-500"},"大小:",-1)),s("span",null,u(l.size?N(l.size):"-"),1)]),s("div",Ie,[e[23]||(e[23]=s("span",{class:"text-gray-500"},"修改时间:",-1)),s("span",null,u(Q(l.modified_at)),1)]),l.description?(r(),_("div",Re,[e[24]||(e[24]=s("span",{class:"text-gray-500"},"描述:",-1)),s("p",qe,u(l.description),1)])):b("",!0)])]),_:2},1024))),128))])):b("",!0),o(pe,{ref_key:"editDialogRef",ref:D,onSaved:e[11]||(e[11]=l=>c("refresh"))},null,512),o(ce,{ref_key:"replayDialogRef",ref:h,scripts:t.scripts},null,8,["scripts"])])}}});const He=_e(Qe,[["__scopeId","data-v-a96b141a"]]);export{He as default};
