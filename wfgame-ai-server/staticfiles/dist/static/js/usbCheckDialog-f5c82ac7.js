import{j as B,n as T,x as q,y as E}from"./index-0964a6d0.js";import{c as L}from"./devices-b4e56127.js";import{s as A}from"./request-28f7529e.js";import{m as O,r as y,A as i,O as P,j as l,u as v,I as t,l as a,z as o,B as f,x,P as $,k as u,y as d,R as _,F as G,p as H,v as J,M as K,aE as Q,_ as W}from"./index-41f05ddf.js";const X={class:"usb-check-content"},Y={key:0,class:"space-y-4"},Z={class:"flex items-center justify-between"},ee={class:"flex items-center"},se={key:0,class:"mb-4"},te={class:"text-sm text-gray-600"},ae={class:"space-y-3"},le={class:"flex items-center space-x-3"},oe={class:"font-medium"},ne={key:0,class:"text-sm text-gray-500"},ce={key:1,class:"text-center py-12"},ie={class:"flex justify-end space-x-2"},ue=O({name:"UsbCheckDialog",__name:"usbCheckDialog",setup(re,{expose:U}){const p=y(!1),r=y(!1),e=y(null),V=()=>{e.value=null,p.value=!0,h()},h=async()=>{await A({apiFunc:L,enableSucceedMsg:!0,succeedMsgContent:"USB连接检查完成！",onBeforeRequest:()=>{r.value=!0},onSucceed:c=>{e.value=c},onFailed:()=>{Q("USB连接检查失败",{type:"error"})},onCompleted:()=>{r.value=!1}})},k=()=>{p.value=!1,e.value=null},z=c=>c==="connected"?q:E,b=c=>c==="connected"?"success":"danger",j=c=>({connected:"已连接",disconnected:"未连接",unauthorized:"未授权",offline:"离线"})[c]||c;return U({showDialog:V}),(c,s)=>{const g=i("el-icon"),C=i("el-tag"),M=i("el-alert"),D=i("el-card"),F=i("el-empty"),S=i("el-button"),N=i("el-dialog"),R=P("loading");return l(),v(N,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=m=>p.value=m),title:"USB连接检查",width:"600px",draggable:!0,onClose:k},{footer:t(()=>[a("div",ie,[o(S,{onClick:k},{default:t(()=>[...s[4]||(s[4]=[f("关闭",-1)])]),_:1}),o(S,{type:"primary",icon:x(B),loading:r.value,onClick:h},{default:t(()=>[...s[5]||(s[5]=[f(" 重新检查 ",-1)])]),_:1},8,["icon","loading"])])]),default:t(()=>{var m,w;return[$((l(),u("div",X,[!r.value&&e.value?(l(),u("div",Y,[o(D,{shadow:"never",class:"border"},{header:t(()=>[a("div",Z,[a("div",ee,[o(g,{class:"mr-2"},{default:t(()=>[o(x(B))]),_:1}),s[1]||(s[1]=a("span",{class:"font-medium"},"检查结果",-1))]),o(C,{type:e.value.success?"success":"danger",size:"large"},{default:t(()=>[f(d(e.value.success?"检查成功":"检查失败"),1)]),_:1},8,["type"])])]),default:t(()=>{var n;return[e.value.message?(l(),u("div",se,[o(M,{title:e.value.message,type:e.value.success?"success":"error","show-icon":"",closable:!1},null,8,["title","type"])])):_("",!0),a("div",te,[a("p",null,"检查时间: "+d(new Date().toLocaleString()),1),a("p",null,"发现设备: "+d(((n=e.value.devices)==null?void 0:n.length)||0)+" 台",1)])]}),_:1}),((m=e.value.devices)==null?void 0:m.length)>0?(l(),v(D,{key:0,shadow:"never",class:"border"},{header:t(()=>[...s[2]||(s[2]=[a("span",{class:"font-medium"},"设备详情",-1)])]),default:t(()=>[a("div",ae,[(l(!0),u(G,null,H(e.value.devices,(n,I)=>(l(),u("div",{key:I,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[a("div",le,[o(g,{class:K(`text-${b(n.status)}`),size:"20"},{default:t(()=>[(l(),v(J(z(n.status))))]),_:2},1032,["class"]),a("div",null,[a("div",oe,d(n.device_id),1),n.message?(l(),u("div",ne,d(n.message),1)):_("",!0)])]),o(C,{type:b(n.status),size:"small"},{default:t(()=>[f(d(j(n.status)),1)]),_:2},1032,["type"])]))),128))])]),_:1})):_("",!0),((w=e.value.devices)==null?void 0:w.length)===0?(l(),v(F,{key:1,description:"未发现USB连接的设备",class:"py-8"})):_("",!0)])):_("",!0),r.value?(l(),u("div",ce,[o(g,{class:"animate-spin text-4xl text-primary mb-4"},{default:t(()=>[o(x(T))]),_:1}),s[3]||(s[3]=a("p",{class:"text-gray-500"},"正在检查USB连接...",-1))])):_("",!0)])),[[R,r.value]])]}),_:1},8,["modelValue"])}}});const ve=W(ue,[["__scopeId","data-v-e5717702"]]);export{ve as default};
